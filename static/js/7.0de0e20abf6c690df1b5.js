webpackJsonp([7],{"45T0":function(t,e){},S8oc:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("Dd8w"),a=s.n(i),n=s("Au9i"),o=s("mtWM"),c=s.n(o),l=s("S6w3"),u=s("NYxO"),r={data:function(){return{title:"发表评论",uploadImg:[],fileUploadImg:[],desc:"",textnumber:100,id:"",userinfo:[],commentimg:[]}},created:function(){this.id=this.$route.params.id,this.userinfo=JSON.parse(this.getlocalStorage)},computed:a()({},Object(u.c)(["getlocalStorage"])),methods:{uploadPublishImg:function(t){var e=this,s=this,i=t.target.files[0]||t.dataTransfer.files[0];if(/.(jpg|jpeg|png)$/.test(i.name))if(s.uploadImg.length>2&&s.commentimg.length>2)Object(n.Toast)({message:"最多只能上传3张图片!",position:"top",duration:2e3});else{this.fileUploadImg.push({src:i});var a=new FileReader;a.readAsDataURL(i),a.onloadend=function(){s.uploadImg.push({src:a.result})};var o=new FormData;o.append("file",i,i.name),c.a.post("http://39.106.7.241:3000/upload",o,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){e.commentimg.push(t.data.url)}).catch(function(t){console.log(t)})}else Object(n.Toast)({message:"上传头像图片只支持PNG,JPG,JEPG 格式!!",position:"top",duration:2e3})},uploadImgDel:function(t){this.uploadImg.splice(t,1),this.commentimg.splice(t,1)},descInput:function(){var t=this.desc.replace(/\s/g,"").length;this.textnumber=100-t},submitPublish:function(){var t=this.commentimg.toString();if(this.desc.length>100||this.desc.length<1)Object(n.Toast)({message:"评论不能为空且最多只能输入100个字符!",position:"top",duration:2e3});else{var e=this.userinfo.id;Object(l.a)({food_id:this.id,content:this.desc,user_id:e,img:t}).then(function(t){Object(n.Toast)({message:t.msg,position:"top",duration:2e3})}).catch(function(t){console.log(t)})}}}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("nav-return",{attrs:{title:t.title}}),t._v(" "),s("div",{staticClass:"publish-content"},[s("mt-field",{staticClass:"textarea",attrs:{placeholder:"您的评论对其他会员都是很重要的参考",type:"textarea",rows:"6"},on:{input:t.descInput},model:{value:t.desc,callback:function(e){t.desc=e},expression:"desc"}}),t._v(" "),s("div",{staticClass:"pir-upload clearfix"},[s("div",{staticClass:"upload-img"},t._l(t.uploadImg,function(e,i){return s("div",{staticClass:"img"},[s("img",{attrs:{src:e.src,alt:""}}),t._v(" "),s("i",{staticClass:"iconfont icon-shanchudise",on:{click:function(e){t.uploadImgDel(i)}}})])})),t._v(" "),s("div",{staticClass:"upload",on:{change:t.uploadPublishImg}},[s("i",{staticClass:"iconfont icon-mn_shangchuantupian_fill"}),t._v(" "),s("input",{staticClass:"file",attrs:{type:"file"}})]),t._v(" "),s("div",{staticClass:"publish-number"},[t._v("最多100字+3张图,剩余输入"+t._s(t.textnumber)+"个字。")])])],1),t._v(" "),s("div",{staticClass:"submit-comment"},[s("div",{staticClass:"btn-submit",on:{click:t.submitPublish}},[t._v("提交评论")])])],1)},staticRenderFns:[]};var m=s("VU/8")(r,d,!1,function(t){s("45T0")},"data-v-55bca9e0",null);e.default=m.exports}});